Human Motion Capture Using a Drone

Abstract
Current motion capture (MoCap) systems generally require markers and multiple calibrated cameras, which can be used only in constrained environments. In this work we introduce a drone-based system for 3D human MoCap. The system only needs an autonomously flying drone with an on-board RGB camera and is usable in various indoor and outdoor environments. A reconstruction algorithm is developed to recover full-body motion from the video recorded by the drone. We argue that, besides the capability of tracking a moving subject, a flying drone also provides fast varying viewpoints, which is beneficial for motion reconstruction. We evaluate the accuracy of the proposed system using our new DroCap dataset and also demonstrate its applicability for MoCap in the wild using a consumer drone.

I. INTRODUCTION
Capturing 3D human body motion is a challenging problem with many applications, e.g., in human-computer interaction, health care and sports. This problem has been conditionally solved by multi-camera motion capture (MoCap) systems (e.g. Vicon and Qualysis) in constrained studios. However, those MoCap systems suffer from their inflexibility and inconvenience: cameras require reliable fixation and frequent calibration, the tracking space is limited and fixed, and the subject should wear special markers. While being more challenging, image-based MoCap with an RGB camera has wider applicability and draws an increasing attention in recent years.Despite the remarkable advances in monocular 3D human pose estimation (see the related-work section), these methods suffer from the inherent ambiguity of single-view reconstruction. The ambiguity is alleviated by learning a 3D pose prior from existing MoCap datasets but cannot be resolved geometrically. Another line of work aims to leverage multi-frame information in a video to reconstruct a nonrigid shape, which is known as nonrigid structure from motion (NRSFM)  #b0 . However, NRSFM requires sufficiently fast camera motion relative to the object  #b1 ,  #b2 , which is impractical if the camera is fixed.To address the above limitations of previous approaches, we propose a novel system for human body MoCap using a drone (see Figure 1  pose estimator produces reliable 2D tracks of body joints from the video, which are input to a 3D pose estimator that robustly initializes reconstruction and suppresses outliers in the 2D tracks. Finally, a NRSFM algorithm is developed to further refine the reconstruction using sequence information and impose the articulation constraint of human body.Our contributions are summarized below:• We propose a novel drone-based system for human MoCap, which is simple (uses only a drone with an on-board RGB camera), flexible (works both indoors and outdoors) and readily usable (needs no particular system calibration or model training). • We argue that, compared to using a static camera, using a drone for video recording is able to provide fast camera motion relative to the subject, which is necessary for motion reconstruction. • We develop a reconstruction algorithm to recover 3D human poses from the drone-based video, which consists of a novel synthesis between single-view pose estimation and sequence-based NRSFM for both robustness and accuracy. • We introduce a novel rank-1 constraint to model the articulation of human body. The proposed constraint is effective and applicable even if the limb lengths of the subject are unknown. • We release a drone-based MoCap dataset named Dro-Cap, which consists of human motion videos captured by a flying drone and ground truth obtained by a Vicon MoCap System. The dataset is available at https: //github.com/daniilidis-group/drocap.

Related work
Markerless human motion capture has been a long standing problem in computer vision. Early work in this area was focused on model-based body tracking in monocular  #b3  or multi-view sequences  #b4 , which in general requires initialization in the first frame and is prone to tracking failures. To address these issues, more robust bottom-up approaches were proposed. These approaches first detect 2D body joints in images and lift them to 3D by assuming a given skeleton  #b2 ,  #b5 ,  #b6 , searching MoCap databases  #b7  or learning statistical models from MoCap data, such as the loosely-limbed model  #b8 , principal component analysis  #b9 -  #b11 , sparse representation  #b12 -  #b14  and body shape models  #b15 ,  #b16 . The main limitation of these approaches is that single-view reconstruction is inherently ill-posed and using geometric priors alone is insufficient to resolve the reconstruction ambiguity. Moreover, the pose prior learned from training data might not be able to explain the pose variability in testing examples resulting in inaccurate reconstructions. While the reconstruction ambiguity can be resolved by using multiple cameras  #b17 -  #b19 , the calibrated multi-camera system is not easily accessible in practice.Another strand of work directly learns the mapping from an image to 3D pose parameters using annotated training data in the form of image-pose pairs, which is referred to as discriminative methods. The advantage of discriminative methods is their ability to leverage image cues, such as shading and occlusion, to reduce the reconstruction ambiguity. A variety of supervised learning methods have been adopted ranging from traditional techniques such as linear regression  #b20 , kernel density estimation  #b21  and Gaussian processes  #b22  to modern deep convolutional neural networks (CNNs)  #b23 ,  #b24 . The main limitation for the discriminative methods is that they require a large number of training images with corresponding 3D pose annotations, which could only be collected using MoCap systems. While there have been large-scale MoCap datasets, such as HumanEva  #b25  and Human3.6M  #b21 , they lack diversity in scenes, subject appearances and actions. As a consequence, the models trained on indoor MoCap datasets are prone to overfitting and can hardly be applied to outdoor images. Some recent works tried to address the scarcity of training data by image synthesis  #b26 ,  #b27 , but the performance of a model trained on synthesized images is not guaranteed when applied to real images due the difference in image statistics.Human motion capture is closely related to nonrigid structure from motion (NRSFM)  #b0 ,  #b28 -  #b31 . In NRSFM, a deformable shape is reconstructed from 2D keypoint tracks extracted from a video. Most of the state-of-the-art NRSFM methods assume a low-rank prior on the deformable shape over time. But unlike the single-view methods that learn bases from MoCap data (e.g.  #b9 ,  #b12 ), NRSFM methods recover the bases during reconstruction without the need of training data, which might better fit the subject. However, it is difficult to apply existing NRSFM pipelines for human motion capture. First, obtaining clean 2D keypoint tracks from a video is difficult especially for fast moving and deformable objects like human body. Second, NRSFM requires fast camera motion  #b1 ,  #b2 , which is impractical in usual scenarios. In this work, we leverage NRSFM but combine it with single-view pose estimation for robust initialization and outlier handling. Moreover, using an on-board camera on a drone for video recording naturally provides fast camera motion.Using flying cameras for human MoCap was proposed in  #b32 , in which the system consists of multiple drones equipped with RGB-D sensors and solves the problem by model-based tracking. However, it requires a scanning stage in which the subject stays static for body shape scanning using depth sensors. Also, RGB-D sensors are restricted to indoor environments and the sensing range is limited. Compared to  #b32 , the proposed system is more widely usable. It only needs a consumer drone with an RGB camera, doesn't require any initialization or scanning stage, and works in both indoor and outdoor environments.

II. APPROACHES
An autonomously flying drone is used for data collection. The drone tracks and orbits the subject with an on-board RGB camera pointing at the subject and recording a video. This functionality has been implemented in many commercial drones such as DJI Phantom 4 and Mavic Pro. The motivation for using a drone instead of a fixed camera for video recording is the capability to provide a sequence of fast varying viewpoints about the subject, which is favorable to motion reconstruction. The importance of camera motion will be experimentally demonstrated in Section III-A.Given a monocular video of the subject recorded from the orbiting drone, we aim to recover the 3D pose sequence of the subject. Our pipeline consists of the following steps: 1) 2D pose detection in which the subject is detected and the 2D pose is estimated in each frame; 2) single-frame initialization in which the camera viewpoints and 3D human poses are initialized by the single-view pose estimation method  #b33 ; 3) multi-frame bundle adjustment in which the camera viewpoints and 3D poses are refined by minimizing the nuclear norm of shape matrix with an articulation constraint. This pipeline is analogous to the successful experience in rigid structure from motion: we detect keypoints, incrementally reconstruct each frame and optimize all unknowns in bundle adjustment.

A. 2D pose detection
The bounding box of the subject in each frame is obtained by either object tracking or detection. For example, the DJI Mavic Pro comes with the active tracking feature and provides the bounding box of the tracked subject. Otherwise, an object detector can be applied to localize the subject in each frame, e.g., the faster R-CNN  #b34  in our experiments.We adopt the stacked hourglass model proposed by Newell et al.  #b35  for 2D pose estimation, which is the state-of-theart method for this problem. It is a fully convolutional neural network (F-CNN) with two stacked hourglass components, each of which consists of a series of downsampling and upsampling layers implementing the bottom-up and topdown processing to integrate local image feature with global context over the whole image. The input to the network is a 2D image with a bounding box around the subject and the output is a set of heat maps with each showing the predicted spatial distribution of the corresponding joint. The details are referred in  #b35 .

B. Single-frame initialization
After the 2D body joints are located in the image sequence, NRSFM methods can be used to reconstruct the 3D poses from the 2D tracks of body joints. However, there are two difficulties for this approach. First, there might be a considerable number of gross errors (outliers) in the detected 2D joints due to occlusion, left-right ambiguity and background clutters. The existing NRSFM methods can hardly handle outliers as NRSFM is an ill-posed problem without much information to correct the input error. Secondly, NRSFM methods typically rely on low-rank factorization which requires a predefined rank while the best rank is often unknown.To address these difficulties, we propose to use a recent method for single-view 3D pose estimation  #b33  to initialize the reconstruction. In  #b33 , a pose dictionary is learned from existing MoCap data and the pose to be reconstructed is assumed as a linear combination of the bases in the dictionary. In this way, the number of unknowns is reduced and the optimization is easier to solve compared to NRSFM where the bases are also unknown. An EM algorithm is also developed in  #b33  to account for uncertainties in CNN based 2D joint localization by incorporating the 3D pose prior learned from MoCap data. Even if the learned pose dictionary cannot perfectly represent the poses to be reconstructed, this step can reliably initialize the camera viewpoints and correct outliers in the 2D input.

C. Multi-frame bundle adjustment
A downside of the single-view reconstruction is that the pose bases learned from other MoCap datasets might not be able to represent the new poses in test images. We propose to solve this problem by adapting the pose bases to the current sequence, which has been realized in NRSFM where a lowrank basis is learned along with other unknowns from 2D keypoint tracks.We adopt the nuclear norm minimization scheme which has been used in many recent NRSFM methods (e.g.  #b29 ,  #b30 ). Compared to factorization based methods, the advantages are two-fold: 1) there is no need to explicitly define a rank; and 2) nuclear norm minimization is convex. We additionally propose a novel rank-1 constraint to model the articulated nature of human body.1) Objective function: Suppose the 2D pose and 3D pose of the subject in frame t are represented by W t ∈ R 2×p and S t ∈ R 3×p respectively, where p is the number of joints. Following the general practice in NRSFM (e.g.  #b0 ,  #b29 ), we assume that an orthographic camera model is used and both W t and S t are centralized, such thatW t = R t S t(1)where R t ∈ R 2×3 denotes the first two rows of the camera rotation matrix at frame t. Given the 2D pose sequence W = {W 1 , · · · , W n }, we recover the 3D pose sequence S = {S 1 , · · · , S n } and the camera rotation sequence R = {R 1 , · · · , R n } by solving the following optimization problem:min S,R,L f (S, R, L) + α S # *(2)where f (S, R, L) is a smooth function composed of the following terms:f (S, R, L) = n t=1 W t − R t S t 2 F + γ (S) − L 2 F (3)The first term in (3) is the sum of reprojection errors over all joints in all frames. The second term enforces the articulation (anthropomorphic) constraint, i.e., the limb lengths should be constant across the sequence. However, as the scale of the reconstructed 3D structure is determined by the given 2D structure under the orthographic projection, the size of the reconstructed structure may vary in different frames depending on the distance from the camera to the subject. Therefore, instead of constraining limb lengths as constants, we enforce that the the ratios between limb lengths to be unchanged across frames. Suppose (·) is a function such that the t-th column of (S) gives the squared limb lengths of S t , (S) should be rank-1 if the articulation constraint is satisfied. To simplify the optimization, we minimize the difference between (S) and an auxiliary rank-1 matrix L instead of directly constraining the rank of (S). L is also unknown and updated during optimization. Note that (S) gives the squared lengths which are differentiable.The second term in (2) is a nonsmooth regularizer that enforces the low-rankness of the reconstructed poses, where · * is the nuclear norm and S # denotes a rearrangement of S such that the t-th column of S # is the vectorized S t . When γ = 0, the formulation (2) is identical to the ones used in previous work for NRSFM (e.g.  #b29 ,  #b30 ).Note that the temporal smoothness of both S t and R t could be conveniently imposed by minimizing their temporal changes. We didn't include them in (2) for simplicity and observed that adding them didn't significantly improve the quantitative results.2) Optimization: The problem in (2) is nonlinear and nonconvex. However, the single-frame initialization stage has provided reliable initialization, which allows us to solve the problem in (2) by local optimization.More specifically, we alternately update each variable while fixing the others. The camera rotation R can be updated with any parameterization of rotation matrix. In accordance with the initialization method  #b33 , we optimize R over the Stiefel manifold, which is implemented using the manifold optimization toolbox  #b36 . The update of L is a standard low-rank approximation problem which can be analytically solved by singular value decomposition. The update of S is more complicated where the objective consists of a smooth loss function and a nonsmooth nuclear norm regularizer. We adopt the proximal gradient (PG) method  #b37 , which updates S iteratively according to the following rule until convergence:S k+1 = arg min S 1 2 S − [S k − 1 µ ∇f S k ] 2 F + α µ S # *(4)where ∇f S k is the gradient of the smooth function f evaluated at the previous estimate S k and µ determines the step size. The subproblem in (4) can be analytically solved by the singular value thresholding  #b38 . To additionally accelerate the convergence of the PG iterations, the Nesterov acceleration scheme  #b37  is also implemented.

III. RESULTS


A. Importance of camera motion
We first demonstrate that fast camera motion is favorable to motion reconstruction, which is the motivation of using drone for data collection in the proposed system. To achieve an arbitrary camera velocity, we use synthetic 2D input by projecting groundtruth 3D body joints to 2D with a virtual orthographic camera rotating around the subject. The 3D data is from Human3.6M  #b21 , a large-scale MoCap dataset. All sequences of 15 actions from Subject 9 and 11 are used for evaluation. The sequences are subsampled at a frame rate of 24 fps and the first 10 seconds of each sequence are used for evaluation. The reconstruction error is used as the error metric:e = min T 1 p p i=1 x i − T (x * i ) 2 ,which calculates the mean distance between the estimated joint locationsx and ground truth x * after a similarity transformation T to align them. The mean reconstruction error averaged over all sequences is plotted in Figure 2 as a function of the angular velocity of the virtual camera. The results of the initial single-view method  #b33  and the bundle adjustment with (γ = 1) and without (γ = 0) the articulation constraint are presented. To avoid training on the same dataset, we learn a pose dictionary from the CMU Mocap dataset  #b39  for singleframe initialization, achieving a mean error around 77mm. If the pose dictionary is learned from the same dataset (the training set of Human3.6M), the mean error is around 48mm, but this setting is impractical in real applications. Figure 2 shows that the multi-frame bundle adjustment improves upon the initial single-view estimation and the accuracy becomes better as the camera rotates faster, which validates that the multi-view information from fast varying viewpoints helps motion reconstruction. The benefit of imposing the articulation constraint is also clearly demonstrated.  Fig. 2. The 3D reconstruction error as a function of the angular velocity of virtual camera. The three curves correspond to the single-view initialization (Initial) by  #b33 , the multi-frame bundle adjustment (BA) and BA without the articulation constraint (BA w/o art.).

B. DroCap dataset
We collect a new drone-based MoCap dataset named DroCap. The ground truth of body motion is provided by a Vicon MoCap system with markers attached to body joints. We mount a GoPro camera on the AscTec Pelican quadrotor platform ( Figure 3) and program it to autonomously track a pre-defined trajectory which is a circle centered at the subject and the desired orientation of the camera is always pointing at the center. The desired speed is 1m/s corresponding to an angular velocity around 25 • /s. During data collection, the subject is doing a variety of actions, such as walking, boxing, and playing soccer, staying at the same location due to the limited indoor space. The current dataset consists of 6 sequences from 2 subjects.The 3D human poses reconstructed from the monocular videos are compared to the ground truth obtained from Vicon. Note that no training data is provided. For the proposed approach, the stacked hourglass model  #b35  trained on MPII  #b41  is adopted for 2D pose estimation and a pose dictionary learned from Human3.6M  #b21  is used for singleframe initialization.The qualitative results on several representative frames are visualized in Figure 4. While the initial single-view estimates by  #b33  have captured global structures, the reconstructions after the multi-frame bundle adjustment are closer to the ground truth recovering more faithful details, e.g., the joint angles of elbows or knees. The bottom-left figure in Figure 4 shows an example where the original 2D pose estimate is inaccurate but the final reconstruction is correct after handling 2D uncertainties by  #b33 .The reconstruction errors at 12 joints (wrists, elbows, shoulders, hips, knees and ankles) are evaluated. The mean reconstruction errors for each sequence are given in Table I. "Initial" and "BA" denote single-frame initialization and multi-frame bundle adjustment, respectively. A baseline method "MF + NNM" is included in comparison, where the 2D joint tracks detected by the same CNN-based detector are input to the state-of-the-art NRSFM method, i.e., matrix factorization for initialization followed by nuclear norm minimization for structure refinement  #b29 . The proposed approach outperforms the baselines, achieving an average   error around 55mm. The performance gain over the singleframe initialization is mainly due to the existence of fast camera motion in drone-based videos that provides richer information for reconstruction. Moreover, the gain is more significant for more repetitive motions such as walking as the pose sequence can be better represented by a lowdimensional subspace. The errors for separate joints are presented in Table II.

C. Outdoor MoCap
Finally, we demonstrate the applicability of the proposed system for outdoor MoCap using consumer drone DJI Mavic Pro. The built-in active tracking function on Mavic Pro is used to track and orbit the moving subject autonomously. Several example sequences are shown in Figure 5, including a YouTube video  #b40  to demonstrate the generalizability of the proposed algorithm. The same as previous experiments, no additional training is used. The generic stacked hourglass model  #b35  trained on MPII  #b41  is used for 2D pose estimation and the pose dictionary learned from Human3.6M  #b21  is used for single-frame initialization. The reconstruction results for several selected frames are shown in Figure 5. As shown, the details of the subject motion are well captured.For example, we can clearly see in the last sequence that the right arm of the subject is swinging while the left hand that holds the remote controller is relatively static.

D. Running time
The reconstruction algorithm was running offline on a desktop with an Intel i7 3.4G CPU, 8G RAM and a GeForce GTX Titan X 6GB GPU. The running time per frame was ∼0.2s for 2D pose estimation and ∼0.3s for singleframe initialization, which could be easily paralleled. For a sequence of 300 frames, the running time for multi-frame bundle adjustment was ∼8s.

IV. DISCUSSION
We proposed a novel system for human MoCap using an autonomously flying drone, aimed to address limitations of existing MoCap systems that rely on markers and static cameras. The proposed system is applicably both indoors and outdoors and is capable of using a consumer drone without the need of particular system calibration or model training. We also introduced a new dataset for drone-based MoCap. This work is an initial effort towards drone-based MoCap, which can be potentially extended, e.g. using multiple drones or active trajectory planning, for more accurate reconstruction.
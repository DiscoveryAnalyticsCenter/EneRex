Permutational Rademacher Complexity A New Complexity Measure for Transductive Learning

Abstract
Transductive learning considers situations when a learner observes m labelled training points and u unlabelled test points with the final goal of giving correct answers for the test points. This paper introduces a new complexity measure for transductive learning called Permutational Rademacher Complexity (PRC) and studies its properties. A novel symmetrization inequality is proved, which shows that PRC provides a tighter control over expected suprema of empirical processes compared to what happens in the standard i.i.d. setting. A number of comparison results are also provided, which show the relation between PRC and other popular complexity measures used in statistical learning theory, including Rademacher complexity and Transductive Rademacher Complexity (TRC). We argue that PRC is a more suitable complexity measure for transductive learning. Finally, these results are combined with a standard concentration argument to provide novel data-dependent risk bounds for transductive learning.

Introduction
Rademacher complexities (  #b13 ,  #b1 ) play an important role in the widely used concentration-based approach to statistical learning theory  #b3 , which is closely related to the analysis of empirical processes  #b20 . They measure a complexity of function classes and provide data-dependent risk bounds in the standard i.i.d. framework of inductive learning, thanks to symmetrization and concentration inequalities. Recently, a number of attempts were made to apply this machinery also to the transductive learning setting  #b21 . In particular, the authors of  #b9  introduced a notion of transductive Rademacher complexity and provided an extensive study of its properties, as well as general transductive risk bounds based on this new complexity measure.In the transductive learning, a learner observes m labelled training points and u unlabelled test points. The goal is to give correct answers on the test points. Transductive learning naturally appears in many modern large-scale applications, including text mining, recommender systems, and computer vision, where often the objects to be classified are available beforehand. There are two different settings of transductive learning, defined by V. Vapnik in his book  #b21 Chap. 8]. The first one assumes that all the objects from the training and test sets are generated i.i.d. from an unknown distribution P . The second one is distribution free, and it assumes that the training and test sets are realized by a uniform and random partition of a fixed and finite general population of cardinality N := m + u into two disjoint subsets of cardinalities m and u; moreover, no assumptions are made regarding the underlying source of this general population. The second setting has gained much attention 5 ([22],  #b8 ,  #b6 ,  #b9 ,  #b7 , and  #b19 ), probably due to the fact that any upper risk bound for this setting directly implies a risk bound also for the first setting  #b21 Theorem 8.1]. In essence, the second setting studies uniform deviations of risks computed on two disjoint finite samples. Following Vapnik's discussion in [6, p. 458], we would also like to emphasize that the second setting of transductive learning naturally appears as a middle step in proofs of the standard inductive risk bounds, as a result of symmetrization or the so-called double-sample trick. This way better transductive risk bounds also translate into better inductive ones.An important difference between the two settings discussed above lies in the fact that the m elements of the training set in the second setting are interdependent, because they are sampled uniformly without replacement from the general population. As a result, the standard techniques developed for inductive learning, including concentration and Rademacher complexities mentioned in the beginning, can not be applied in this setting, since they are heavily based on the i.i.d. assumption. Therefore, it is important to study empirical processes in the setting of sampling without replacement.Previous work. A large step in this direction was made in  #b9 , where the authors presented a version of McDiarmid's bounded difference inequality  #b4  for sampling without replacement together with the Transductive Rademacher Complexity (TRC). As a main application the authors derived an upper bound on the binary test error of a transductive learning algorithm in terms of TRC. However, the analysis of  #b9  has a number of shortcomings. Most importantly, TRC depends on the unknown labels of the test set. In order to obtain computable risk bounds, the authors resorted to the contraction inequality  #b14 , which is known to be a loose step  #b16 , since it destroys any dependence on the labels.Another line of work was presented in  #b19 , where variants of Talagrand's concentration inequality were derived for the setting of sampling without replacement. These inequalities were then applied to achieve transductive risk bounds with fast rates of convergence o(m −1/2 ), following a localized approach  #b0 . In contrast, in this work we consider only the worst-case analysis based on the global complexity measures. An analysis under additional assumptions on the problem at hand, including Mammen-Tsybakov type low noise conditions  #b3 , is an interesting open question and left for future work.Summary of our results. This paper continues the analysis of empirical processes indexed by arbitrary classes of uniformly bounded functions in the setting of sampling without replacement, initiated by  #b9 . We introduce a new complexity measure called permutational Rademacher complexity (PRC) and argue that it captures the nature of this setting very well. Due to space limitations we present the analysis of PRC only for the special case when the training and test sets have the same size m = u, which is nonetheless sufficiently illustrative 6 .We prove a novel symmetrization inequality (Theorem 2), which shows that the expected PRC and the expected suprema of empirical processes when sampling without replacement are equivalent up to multiplicative constants. Quite remarkably, the new upper and lower bounds (the latter is often called desymmetrization inequality) both hold without any additive terms when m = u, in contrast to the standard i.i.d. setting, where an additive term of order O(m −1/2 ) is unavoidable in the lower bound. For TRC even the upper symmetrization inequality  #b9 Lemma 4] includes an additive term of the order O(m −1/2 ) and no desymmetrization inequality is known. This suggests that PRC may be a more suitable complexity measure for transductive learning. We would also like to note that the proof of our new symmetrization inequality is surprisingly simple, compared to the one presented in  #b9 .Next we compare PRC with other popular complexity measures used in statistical learning theory. In particular, we provide achievable upper and lower bounds, relating PRC to the conditional Rademacher complexity (Theorem 3). These bounds show that the PRC is upper and lower bounded by the conditional Rademacher complexity up to additive terms of orders o(m −1/2 ) and O(m −1/2 ) respectively, which are achievable (Lemma 1). In addition to this, Theorem 3 also significantly improves bounds on the complexity measure called maximum discrepancy presented in [2, Lemma 3]. We also provide a comparison between expected PRC and TRC (Corollary 1), which shows that their values are close up to small multiplicative constants and additive terms of order O(m −1/2 ).Finally, we apply these results to obtain a new computable data-dependent risk bound for transductive learning based on the PRC (Theorem 5), which holds for any bounded loss functions. We conclude by discussing the advantages of the new risk bound over the previously best known one of  #b9 .

Notations
We will use calligraphic symbols to denote sets, with subscripts indicating their cardinalities: card(Z m ) = m. For any function f we will denote its average value computed on a finite set S byf (S). In what follows we will consider an arbitrary space Z (for instance, a space of input-output pairs) and class F of functions (for instance, loss functions) mapping Z to R. Most of the proofs are deferred to the last section for improved readability.Arguably, one of the most popular complexity measures used in statistical learning theory is the Rademacher complexity (  #b14 ,  #b13 ,  #b1 ):Definition 1 (Conditional Rademacher complexity). Fix any subset Z m = {Z 1 , . . . , Z m } ⊆ Z. The following random quantity is commonly known as a conditional Rademacher complexity:R m (F, Z m ) = E ǫ 2 m sup f ∈F m i=1 ǫ i f (Z i ) , where ǫ = {ǫ i } m i=1 are i.i.d.Rademacher signs, taking values ±1 with probabilities 1/2. When the set Z m is clear from the context we will simply writeR m (F ).As discussed in the introduction, Rademacher complexities play an important role in the analysis of empirical processes and statistical learning theory. However, this measure of complexity was devised mainly for the i.i.d. setting, which is different from our setting of sampling without replacement. The following complexity measure was introduced in [10] to overcome this issue:Definition 2 (Transductive Rademacher complexity). Fix any set Z N = {Z 1 , . . . , Z N } ⊆ Z, positive integers m, u such that N = m + u, and p ∈ 0, 1 2 .The following quantity is called Transductive Rademacher complexity (TRC):R td m+u (F, Z N , p) = 1 m + 1 u E σ sup f ∈F N i=1 σ i f (Z i ) , where σ = {σ 1 } m+u i=1 are i.i.d. randomvariables taking values ±1 with probabilities p and 0 with probability 1 − 2p.We summarize the importance of these two complexity measures in the analysis of empirical processes when sampling without replacement in the following result: Theorem 1. Fix an N -element subset Z N ⊆ Z and let m < N elements of Z m be sampled uniformly without replacement from Z N . Also let m elements of X m be sampled uniformly with replacement from Z N . Denote Z u := Z N \ Z m with u := card(Z u ) = N − m. The following upper bound in terms of the i.i.d. Rademacher complexity was provided in  #b19 :E Zm sup f ∈F f (Z u ) −f (Z m ) ≤ N u · E Xm R m (F, X m ) .(1)The following bound in terms of TRC was provided in  #b9 . Assume that functions in F are uniformly bounded by B. Then for p 0 := mu N 2 and c 0 < 5.05:E Zm sup f ∈F f (Z u ) −f (Z m ) ≤R td m+u (F, Z N , p 0 ) + c 0 B N min(m, u) mu .(2)While (1) did not explicitly appear in  #b19 , it can be immediately derived using [ Q m,n (F, Z m ) = E Zn sup f ∈F f (Z k ) −f (Z n ) ,where Z n is a random subset of Z m containing n elements sampled uniformly without replacement and Z k := Z m \ Z n . When the set Z m is clear from the context we will simply writeQ m,n (F ).The name PRC is explained by the fact that if m is even then the definitions ofQ m,m/2 (F ) andR m (F ) are very similar. Indeed, the only difference is that the expectation in the PRC is over the randomly permuted sequence containing equal number of " − 1" and " + 1", whereas in Rademacher complexity the average is w.r.t. all the possible sequences of signs. The term "permutation complexity" has already appeared in  #b15 , where it was used to denote a novel complexity measure for a model selection. However, this measure was specific to the i.i.d. setting and binary loss. Moreover, the bounds presented in  #b15  were of the same order as the risk bounds based on the Rademacher complexity with worse constants in the slack term.

Symmetrization and Comparison Results
We start with showing a version of the i.i.d. symmetrization inequality (references can be found in  #b14 ,  #b12 ) for the setting of sampling without replacement. It shows that the expected supremum of empirical processes in this setting is up to multiplicative constants equivalent to the expected PRC. 1 2 E Zm Q m,m/2 (F, Z m ) ≤ E Zm sup f ∈F f (Z u ) −f (Z m ) ≤ E Zm Q m,n (F, Z m ) .The inequalities also hold if we include absolute values inside the suprema.Proof. The proof can be found in Sect. 5.1.This inequality should be compared to the previously known complexity bounds of Theorem 1. First of all, in contrast to  #b0  and (2) the new bound provides a two sided control, which shows that PRC is a "correct" complexity measure for our setting. It is also remarkable that the lower bound (commonly known as Q m,m/2 (F, Z m ) ≤ 1 + 2 √ 2πm − 2 R m (F, Z m ).(3)Moreover, if the functions in F are absolutely bounded by B thenQ m,m/2 (F, Z m ) −R m (F, Z m ) ≤ 2B √ m .(4)The results also hold if we include absolute values inside suprema inQ m,n ,R m .Proof. Conceptually the proof is based on the coupling between a sequence {ǫ i } m i=1 of i.i.d. Rademacher signs and a uniform random permutation {η i } m i=1 of a set containing m/2 plus and m/2 minus signs. This idea was inspired by the techniques used in  #b10 . The detailed proof can be found in Sect. 5.2.Note that a typical order ofR m (F ) is O(m −1/2 ), thus the multiplicative upper bound (3) can be much tighter than the upper bound of (4). We would also like to note that Theorem 3 significantly improves bounds of Lemma 3 in  #b1 , which relate the so-called maximal discrepancy measure of the class F to its Rademacher complexity (for the further discussion we refer to Appendix).Our next result shows that bounds of Theorem 3 are essentially tight. Q m,m/2 (F ′ m , Z m ) = 0, (2m) −1/2 ≤R m (F ′ m , Z m ) ≤ 2m −1/2 ;(5)Q m,m/2 (F ′′ m , Z m ) = 1, 1 − 2 πm ≤R m (F ′′ m , Z m ) ≤ 1 − 4 5 2 πm .(6)Proof. The proof can be found in Sect. 5.3.Inequalities (5) R N (F, Z N ) ≤R td m+u (F, Z N , 1/4) ≤ 2R N (F, Z N ).R td m+u (F, Z N , 1/4) = 4 N E (ǫ,η) sup f ∈F m+u i=1 ǫ i η i f (Z i ) ≥ 4 N E ǫ sup f ∈F m+u i=1 ǫ i 1 2 f (Z i ) .Together with Theorems 2 and 3 this result shows that when m = u the PRC can not be much larger than transductive Rademacher complexity: Corollary 1. Using notations of Theorem 2, we have:E Zm Q m,m/2 (F, Z m ) ≤ 2 + 4 √ 2πN − 2 R td m+u (F, Z N , 1/4).

If functions in F are uniformly bounded by B then we also have a lower bound:
E Zm Q m,m/2 (F, Z m ) ≥ 1 2R td m+u (F, Z N , 1/4) + 2B √ N . Proof. Simply notice that EZ m sup f ∈F f (Z u ) −f (Z m ) =Q N,m (F, Z N ).

Transductive Risk Bounds
Next we will use the results of Sect. 3 to obtain a new transductive risk bound. First we will shortly describe the setting. We will consider the second, distribution-free setting of transductive learning described in the introduction. Fix any finite general population of input-output pairs Z N = {(x i , y i )} N i=1 ⊆ X ×Y, where X and Y are arbitrary input and output spaces. We make no assumptions regarding underlying source of Z N . The learner receives the labeled training set Z m consisting of m < N elements sampled uniformly without replacement from Z N . The remaining test set Z u := Z N \ Z m is presented to the learner without labels (we will use X u to denote the inputs of Z u ). The goal of the learner is to find a predictor in the fixed hypothesis class H based on the training sample Z m and unlabelled test points X u , which has a small test risk measured using bounded loss function ℓ : Y × Y → err u (h) ≤ err m (h) +R td m+u (L H , Z N , 1/4) + 11 2 N + 2N log(1/δ) (N − 1/2) 2 .(7)Using results of Sect. 3 we obtain the following risk bound:Theorem 5. If m = u and n ∈ {1, . . . , m − 1} then with probability at least 1 − δ over the random training set Z m any h ∈ H satisfies:err u (h) ≤ err m (h) + E Sm Q m,n (L H , Z m ) + 2N log(1/δ) (N − 1/2) 2 .(8)Moreover, with probability at least 1 − δ any h ∈ H satisfies:err u (h) ≤ err m (h) +Q m,n (L H , Z m ) + 2 2N log(2/δ) (N − 1/2) 2 .(9)Proof. The proof can be found in Sect. 5.4.We conclude by comparing risk bounds of Theorems 5 and 4: 1. First of all, the upper bound of (9) is computable. This bound is based on the concentration argument, which shows that the expected PRC (appearing in (8)) can be nicely estimated using the training set. Meanwhile, the upper bound of (7) depends on the unknown labels of the test set through TRC. In order to make it computable the authors of  #b9  resorted to the contraction inequality, which allows to drop any dependence on the labels for Lipschitz losses, which is known to be a loose step  #b16 .2. Moreover, we would like to note that for binary loss function TRC (as well as the Rademacher complexity) does not depend on the labels at all. Indeed, this can be shown by writing ℓ 01 (y, y ′ ) = (1 − yy ′ )/2 for y, y ′ ∈ {−1, +1} and noting that σ i and σ i y are identically distributed for σ i used in Definition 2. This is not true for PRC, which is sensitive to the labels even in this setting. As a future work we hope to use this fact for analysis in the low noise setting  #b3 .3. The slack term appearing in (8) is significantly smaller than the one of (7). For instance, if δ = 0.01 then the latter is 13 times larger. This is caused by the additive term in symmetrization inequality  #b1 . At the same time, Corollary 1 shows that the complexity term appearing in (8) is at most two times larger than TRC, appearing in (7).  $b4 . Comparison result of Theorem 3 shows that the upper bound of (9) is also tighter than the one which can be obtained using (1) and conditional Rademacher complexity.5. Similar upper bounds (up to extra factor of 2) also hold for the excess risk err u (h m ) − inf h∈H err u (h), where h m minimizes the training risk err m over H. This can be proved using a similar argument to Theorem 5.6. Finally, one more application of the concentration argument can simplify the computation of PRC, by estimating the expected value appearing in Definition 3 with only one random partition of Z m . E Sm 1 m m i=1 s i = 1 N m Sm⊆C 1 m z∈Sm z = 1 m N m N i=1 N − 1 m − 1 c i = 1 N N i=1 c i .Proof (of Theorem 2). Fix any positive integers n and k such that n + k = m, which implies n < m and k < m = u. Note that Lemma 3 implies:f (Z u ) = E S k f (S k ) ,f (Z m ) = E Sn f (S n ) ,where S k and S n are sampled uniformly without replacement from Z u and Z m respectively. Using Jensen's inequality we get:E Zm sup f ∈F f (Z u ) −f (Z m ) = E Zm sup f ∈F E S k f (S k ) − E Sn f (S n ) ≤ E (Zm,S k ,Sn) sup f ∈F f (S k ) −f (S n ) .(10)The marginal distribution of (S k , S n ), appearing in (10), can be equivalently described by first sampling Z m from Z N , then S n from Z m (both times uniformly without replacement), and setting S k := Z m \ S n (recall that n + k = m). ThusE (Zm,S k ,Sn) sup f ∈F f (S k ) −f (S n ) = E Zm E Sn sup f ∈F f (Z m \ S n ) −f (S n ) Z m ,which completes the proof of the upper bound. We have shown that for n ∈ {1, . . . , m − 1} and k := m − n:E Zm Q m,n (F, Z m ) = E (Z k ,Zn) sup f ∈F f (Z k ) −f (Z n ) ,(11)where Z n and Z k are sampled uniformly without replacement from Z N and Z N \ Z n respectively. Let Z m−n be sampled uniformly without replacement from Z N \ (Z n ∪ Z k ) and let Z u−k be the remaining u − k elements of Z N . Using Lemma 3 once again we get:E f (Z m−n ) (Z n , Z k ) = E f (Z u−k ) (Z n , Z k ) .We can rewrite the r.h.s. of (11) as:E (Zn,Z k ) sup f ∈F f (Z k ) −f (Z n ) + E f (Z u−k ) −f (Z m−n ) (Z n , Z k ) ≤ E sup f ∈F f (Z k ) −f (Z n ) +f (Z u−k ) −f (Z m−n ) ,where we have used Jensen's inequality. If we take n * = k * = m/2 we getE Zm Q m,m/2 (F, Z m ) ≤ E sup f ∈F 2f (Z k * ∪ Z u−k * ) − 2f (Z n * ∪ Z m−n * ) .It is left to notice that the random subsets Z k * ∪ Z u−k * and Z n * ∪ Z m−n * have the same distributions as Z u and Z m .

Proof of Theorem 3
Let m = 2 · n, ǫ = {ǫ i } m i=1 be i.i.d. Rademacher signs, and η = {η i } m i=1 be a uniform random permutation of a set containing n plus and n minus signs. The proof of Theorem 3 is based on the coupling of random variables ǫ and η, which is described in Lemma 4. We will need a number of definitions. T (v) = arg min v ′ ∈Sm v − v ′ 1 ,which consists of the points in S m closest to v in Hamming metric. For any v ∈ B m let t(v) be a random element of T (v), distributed uniformly. We will use t i (v) to denote i-th coordinate of the vector t(v).

Remark 1.
If v ∈ S m then T (v) = {v}. Otherwise, T (v) will clearly contain more than one element of S m . Namely, it can be shown, that if for some positive integer q it holds that m i=1 v i = q, then q is necessarily even and T (v) consists of all the vectors in S m which can be obtained by replacing q/2 of +1 signs in v with −1 signs, and thus in this case card T (v) = (m+q)/2 q/2 . Lemma 4 (Coupling). Assume that m = 2 · n. Then the random sequence t(ǫ) has the same distribution as η.Proof. Note that the support of t(ǫ) is equal to S m . From symmetry it is easy to conclude that the distribution of t(ǫ) is exchangable. This means that it is invariant under permutations and as a consequence uniform on S m .Next result is in the core of the multiplicative upper bound (3).Lemma 5. Assume that m = 2 · n. For any q ∈ {1, . . . , m} the following holds:E[ǫq|t(ǫ)] = 1 − 2 −m m n t q (ǫ) ≥ 1 − 2(2πm) −1/2 t q (ǫ).Proof. We will first upper bound P{ǫ q = t q (ǫ)|t(ǫ) = e}, where e = {e i } m i=1 is (w.l.o.g.) a sequence of n plus signs followed by a sequence of n minus signs.P{ǫ q = t q (ǫ)|t(ǫ) = e} = P{ǫ q = t q (ǫ) ∩ t(ǫ) = e} P{t(ǫ) = e} = m n 2 −m s P{ǫ q = t q (ǫ) ∩ t(ǫ) = e|ǫ = s},(12)where we have used Lemma 4 and the sum is over all different sequences of m signs s = {s i } m i=1 . For any s denote S(s) = n j=1 s j and consider terms in (12) corresponding to s with S(s) = 0, S(s) > 0, and S(s) < 0:Case 1: S(s) = 0. These terms will be zero, since t(s) = s. Case 2: S(s) > 0. This means that s "has more plus signs than it should" and according to Remark 1 the mapping t(·) will replace several of "+1" with "-1". In particular, if s q = −1 then t q (s) = s q and thus the corresponding terms will be zero. If s q = 1 and in the same time e q = 1 the event {ǫ q = t q (ǫ) ∩ t(ǫ) = e} also can not hold. Moreover, note that identity e = t(s) can hold only if e ∈ T (s), which necessarily leads to j ∈ {1, . . . , m} : s j = −1 ⊆ j ∈ {1, . . . , m} : e j = −1 .From this we conclude that if q ∈ {1, . . . , n} then all the terms corresponding to s with S(s) > 0 are zero. We will use U q (e) to denote the subset of B m consisting of sequences s, such that (a) S(s) > 0, (b) s q = 1, and (c) condition  #b12  holds. It can be seen that if s ∈ U q (e) then:P{ǫ q = t q (ǫ) ∩ t(ǫ) = e|ǫ = s} = n + S(s)/2 S(s)/2 −1 .This holds since, according to Remark 1, t(ǫ) can take exactly n+S(s)/2 S(s)/2 different values, while only one of them is equal to e.Let us compute the cardinality of U q (e) for q ∈ {n + 1, . . . , m}. It is easy to check that condition S(s) = 2j for some positive integer j implies that s has exactly n − j minus signs. Considering the fact that s q = 1 for s ∈ U q (e) we have:card U q (e) = n − 1 n − j .Combining everything together we have:s : S(s)>0 P{ǫ q = t q (ǫ) ∩ t(ǫ) = e|ǫ = s} = ½{q > n} n j=1 n−1 n−j n+j j .Finally, it is easy to show using induction that: n j=1 n−1 n−j n+j j = 1 2 .Case 3: S(s) < 0. We can repeat all the steps of the previous case and get:s : S(s)<0 P{ǫ q = t q (ǫ) ∩ t(ǫ) = e|ǫ = s} = 1 2 ½{q ≤ n}.Accounting for these three cases in  #b11  we conclude thatP{ǫ q = t q (ǫ)|t(ǫ) = e} = 1 2 m n 2 −m ≤ 1 √ 2πm ,where we have used the upper bound on the binomial coefficient from  #b18 Corollary 2.4]. We can conclude the proof of lemma by writing:E[ǫq|t(ǫ)] = t q (ǫ) (1 − 2P{ǫ q = t q (ǫ)|t(ǫ)}) ≥ t q (ǫ) 1 − 2(2πm) −1/2 .Proof (of Theorem 3). First we prove  #b2 . Let Z m = {z 1 , . . . , z m }. We can write:Q m,n (F ) = E sup f ∈F 2 m m i=1 t i (ǫ)f (z i )(14)≤ 1 − 2(2πm) −1/2 −1 E sup f ∈F 2 m m i=1 E[ǫi|t(ǫ)]f (z i )(15)≤ 1 + 2 √ 2πm − 2 E sup f ∈F 2 m m i=1 ǫ i f (z i ) ,(16)where we have used coupling Lemma 4 in (14), Lemma 5 in (15), and Jensen's inequality in  #b15 . This completes the proof of (3). Next we prove (4). We have:Q m,n (F ) −R m (F ) = E η sup f ∈F 2 m m i=1 η i f (z i ) − E ǫ sup f ∈F 2 m m i=1 ǫ i f (z i ) .Using Lemma 4 and Jensen's inequality we further get:Q m,n (F ) −R m (F ) = E ǫ E t sup f ∈F 2 m m i=1 t i (ǫ)f (z i ) ǫ − E ǫ sup f ∈F 2 m m i=1 ǫ i f (z i ) ≤ E ǫ E t sup f ∈F 2 m m i=1 t i (ǫ)f (z i ) − sup f ∈F 2 m m i=1 ǫ i f (z i ) ǫ ,(17)where we have, perhaps misleadingly, denoted the conditional expectation with respect to the uniform choice from T (ǫ) given ǫ using Et[ · |ǫ]. Next we have:sup f ∈F 2 m m i=1 t i (ǫ)f (z i ) − sup f ∈F 2 m m i=1 ǫ i f (z i ) ≤ sup f ∈F 4 m i∈S(ǫ,t) ǫ i f (z i ) ,(18)where S(ǫ, t) ⊆ {1, . . . , m} is a subset of indices, s.t. t(ǫ) i = ǫ i iff i ∈ S(ǫ, t).We can continue by writingsup f ∈F 2 m m i=1 t i (ǫ)f (z i ) − sup f ∈F 2 m m i=1 ǫ i f (z i ) ≤ 4 m sup f ∈F i∈S(ǫ,t) |f (z i )|.(19)Note that since functions in F are absolutely bounded by B:sup f ∈F i∈S(ǫ,t)|f (z i )| ≤ B · card (S(ǫ, t)) .Returning to  #b16  and using Remark 1 we obtain:Q m,n (F ) − 2R m (F ) ≤ 4B m E ǫ E t [card (S(ǫ, t)) |ǫ] = E ǫ 1 2 m i=1 ǫ i .Khinchin's inequality  #b14 Lemma 4.1] together with the best known constant due to  #b11  gives Eǫ [| m i=1 ǫ i | ] ≤ √ m, which completes the proof of (4).

Proof of Lemma 5
Proof. Let Z m = {z 1 , . . . , z m }. Take F ′ m to be a set of two constant functions, f 1 (z) = 1 and f 2 (z) = 0 for all z ∈ Z. Clearly,Q m,n (F ′ m ) = 0. In the same time:E ǫ sup f ∈F ′ m 2 m m i=1 ǫ i f (z i ) = E ǫ max 0, 2 m m i=1 ǫ i ≤ E ǫ 2 m m i=1 ǫ i ≤ 2 √ m ,where we used Khinchin's inequality. Finally, Khinchin's inequality also gives:E ǫ max 0, 2 m m i=1 ǫ i = 1 2 E ǫ 2 m m i=1 ǫ i ≥ 1 √2m . 

Proof of Theorem 5
The following version of McDiarmid's bounded difference inequality for the setting of sampling without replacement was presented in [10, Lemma 2] and further improved in  #b7 Theorem 5]:Theorem 6 ([10],  #b7 ). Let Z m be sampled uniformly without replacement from a fixed set Z m+u ⊆ Z of m+u elements. Let g : Z m → R be a symmetric function s.t. for all i = 1, . . . , m and for all z 1 , . . . , z m ∈ Z and z ′ 1 , . . . , z ′ m ∈ Z, g(z 1 , . . . , z m ) − g(z 1 , . . . , z i−1 , z ′ i , z i+1 , . . . , z m ) ≤ c.Then if m = u with probability not less than 1 − δ the following holds:g ≤ E[g] + c 2 N 3 log(1/δ) 8(N − 1/2) 2 .Note that function sup h∈H (err h (Z u ) − err h (Z m )) maps (X × Y) m to R and is of course symmetric. Straightforward calculations show that this function satisfies bounded difference condition  #b19  with c = 1 m + 1 u ([10, Inequality 9]). Theorem 6 states that with probability not less than 1 − δ: Using upper bound of Theorem 2 with L H in place of F we complete the proof of (8). Next, consider a symmetric function −Q m,n (L H , Z m ) which also maps (X × Y) m to R. It can be shown again that it satisfies bounded difference condition  #b19  with c = 2 m . And thus, Theorem 6 gives that with probability not less than 1 − δ: Using this inequality together with (8) in a union bound we obtain the second inequality of the theorem.

Footnote
5 : For the extensive overview of transductive risk bounds we refer the reader to[18].
6 : All the results presented in this paper are also available for the general m = u case, but we defer them to a future extended version of this paper.